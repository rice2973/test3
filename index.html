<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <tittle>checkin</title>
</head>
<body>
<div>Teachable Machine Image Model</div>
<button type="button" onclick="init()">Start</button>
<div id="webcam-container"></div>
<div id="label-container"></div>
<div id="label-container2"></div>
<div id="debuk"></div>
<script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@1.3.1/dist/tf.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/@teachablemachine/image@0.8/dist/teachablemachine-image.min.js"></script>
<script type="text/javascript">
    // More API functions here:
    // https://github.com/googlecreativelab/teachablemachine-community/tree/master/libraries/image

    // the link to your model provided by Teachable Machine export panel
    const URL = "./my/";
    const URL2 = "./myke/";
    
    let model, webcam, labelContainer, maxPredictions;
    let model2, labelContainer2, maxPredictions2;

    // Load the image model and setup the webcam
    async function init() {
        const modelURL = URL + "model.json";
        const metadataURL = URL + "metadata.json";
        const model2URL = URL2 + "model.json";
        const metadata2URL = URL2 + "metadata.json";

        // load the model and metadata
        // Refer to tmImage.loadFromFiles() in the API to support files from a file picker
        // or files from your local hard drive
        // Note: the pose library adds "tmImage" object to your window (window.tmImage)
        model = await tmImage.load(modelURL, metadataURL);
        model2 = await tmImage.load(model2URL, metadata2URL);
        maxPredictions = model.getTotalClasses();
        maxPredictions2 = model2.getTotalClasses();

        // Convenience function to setup a webcam
        const flip = true; // whether to flip the webcam
        webcam = new tmImage.Webcam(200, 200, flip); // width, height, flip
        await webcam.setup(); // request access to the webcam
        await webcam.play();
        window.requestAnimationFrame(loop);

        // append elements to the DOM
        document.getElementById("webcam-container").appendChild(webcam.canvas);
        labelContainer = document.getElementById("label-container");
        labelContainer2 = document.getElementById("label-container2");
        for (let i = 0; i < 5; i++) { // and class labels
            labelContainer.appendChild(document.createElement("div"));
        }
        for (let j = 0; j < 14; j++) {
            labelContainer2.appendChild(document.createElement("div"));
        }
    }

    async function loop() {
        webcam.update(); // update the webcam frame
        await predict();
        window.requestAnimationFrame(loop);
    }

    // run the webcam image through the image model
    async function predict() 
    {
        // predict can take in an image, video or canvas html element
        const prediction = await model.predict(webcam.canvas);
        const prediction2 = await model2.predict(webcam.canvas);
        ank = "何もっ"
        tal = "なかった"
        const A1 = prediction[0].probability.toFixed(2) * prediction2[0].probability.toFixed(2);
        const A2 = prediction[0].probability.toFixed(2) * prediction2[1].probability.toFixed(2);
        const A3 = prediction[0].probability.toFixed(2) * prediction2[2].probability.toFixed(2);
        const A4 = prediction[0].probability.toFixed(2) * prediction2[3].probability.toFixed(2);
        const A5 = prediction[0].probability.toFixed(2) * prediction2[4].probability.toFixed(2);
        const A6 = prediction[0].probability.toFixed(2) * prediction2[5].probability.toFixed(2);
        const A7 = prediction[0].probability.toFixed(2) * prediction2[6].probability.toFixed(2);
        const A8 = prediction[0].probability.toFixed(2) * prediction2[7].probability.toFixed(2);
        const A9 = prediction[0].probability.toFixed(2) * prediction2[8].probability.toFixed(2);
        const A10 = prediction[0].probability.toFixed(2) * prediction2[9].probability.toFixed(2);
        const AJ = prediction[0].probability.toFixed(2) * prediction2[10].probability.toFixed(2);
        const AQ = prediction[0].probability.toFixed(2) * prediction2[11].probability.toFixed(2);
        const AK = prediction[0].probability.toFixed(2) * prediction2[12].probability.toFixed(2);
        const B1 = prediction[1].probability.toFixed(2) * prediction2[0].probability.toFixed(2);
        const B2 = prediction[1].probability.toFixed(2) * prediction2[1].probability.toFixed(2);
        const B3 = prediction[1].probability.toFixed(2) * prediction2[2].probability.toFixed(2);
        const B4 = prediction[1].probability.toFixed(2) * prediction2[3].probability.toFixed(2);
        const B5 = prediction[1].probability.toFixed(2) * prediction2[4].probability.toFixed(2);
        const B6 = prediction[1].probability.toFixed(2) * prediction2[5].probability.toFixed(2);
        const B7 = prediction[1].probability.toFixed(2) * prediction2[6].probability.toFixed(2);
        const B8 = prediction[1].probability.toFixed(2) * prediction2[7].probability.toFixed(2);
        const B9 = prediction[1].probability.toFixed(2) * prediction2[8].probability.toFixed(2);
        const B10 = prediction[1].probability.toFixed(2) * prediction2[9].probability.toFixed(2);
        const BJ = prediction[1].probability.toFixed(2) * prediction2[10].probability.toFixed(2);
        const BQ = prediction[1].probability.toFixed(2) * prediction2[11].probability.toFixed(2);
        const BK = prediction[1].probability.toFixed(2) * prediction2[12].probability.toFixed(2);
        const C1 = prediction[2].probability.toFixed(2) * prediction2[0].probability.toFixed(2);
        const C2 = prediction[2].probability.toFixed(2) * prediction2[1].probability.toFixed(2);
        const C3 = prediction[2].probability.toFixed(2) * prediction2[2].probability.toFixed(2);
        const C4 = prediction[2].probability.toFixed(2) * prediction2[3].probability.toFixed(2);
        const C5 = prediction[2].probability.toFixed(2) * prediction2[4].probability.toFixed(2);
        const C6 = prediction[2].probability.toFixed(2) * prediction2[5].probability.toFixed(2);
        const C7 = prediction[2].probability.toFixed(2) * prediction2[6].probability.toFixed(2);
        const C8 = prediction[2].probability.toFixed(2) * prediction2[7].probability.toFixed(2);
        const C9 = prediction[2].probability.toFixed(2) * prediction2[8].probability.toFixed(2);
        const C10 = prediction[2].probability.toFixed(2) * prediction2[9].probability.toFixed(2);
        const CJ = prediction[2].probability.toFixed(2) * prediction2[10].probability.toFixed(2);
        const CQ = prediction[2].probability.toFixed(2) * prediction2[11].probability.toFixed(2);
        const CK = prediction[2].probability.toFixed(2) * prediction2[12].probability.toFixed(2);
        const D1 = prediction[3].probability.toFixed(2) * prediction2[0].probability.toFixed(2);
        const D2 = prediction[3].probability.toFixed(2) * prediction2[1].probability.toFixed(2);
        const D3 = prediction[3].probability.toFixed(2) * prediction2[2].probability.toFixed(2);
        const D4 = prediction[3].probability.toFixed(2) * prediction2[3].probability.toFixed(2);
        const D5 = prediction[3].probability.toFixed(2) * prediction2[4].probability.toFixed(2);
        const D6 = prediction[3].probability.toFixed(2) * prediction2[5].probability.toFixed(2);
        const D7 = prediction[3].probability.toFixed(2) * prediction2[6].probability.toFixed(2);
        const D8 = prediction[3].probability.toFixed(2) * prediction2[7].probability.toFixed(2);
        const D9 = prediction[3].probability.toFixed(2) * prediction2[8].probability.toFixed(2);
        const D10 = prediction[3].probability.toFixed(2) * prediction2[9].probability.toFixed(2);
        const DJ = prediction[3].probability.toFixed(2) * prediction2[10].probability.toFixed(2);
        const DQ = prediction[3].probability.toFixed(2) * prediction2[11].probability.toFixed(2);
        const DK = prediction[3].probability.toFixed(2) * prediction2[12].probability.toFixed(2);
        
        lA1 = A1.toFixed(2);
        lA2 = A2.toFixed(2);
        lA3 = A3.toFixed(2);
        lA4 = A4.toFixed(2);
        lA5 = A5.toFixed(2);
        lA6 = A6.toFixed(2);
        lA7 = A7.toFixed(2);
        lA8 = A8.toFixed(2);
        lA9 = A9.toFixed(2);
        lA10 = A10.toFixed(2);
        lAJ = AJ.toFixed(2);
        lAQ = AQ.toFixed(2);
        lAK = AK.toFixed(2);
        lB1 = B1.toFixed(2);
        lB2 = B2.toFixed(2);
        lB3 = B3.toFixed(2);
        lB4 = B4.toFixed(2);
        lB5 = B5.toFixed(2);
        lB6 = B6.toFixed(2);
        lB7 = B7.toFixed(2);
        lB8 = B8.toFixed(2);
        lB9 = B9.toFixed(2);
        lB10 = B10.toFixed(2);
        lBJ = BJ.toFixed(2);
        lBQ = BQ.toFixed(2);
        lBK = BK.toFixed(2);
        lC1 = C1.toFixed(2);
        lC2 = C2.toFixed(2);
        lC3 = C3.toFixed(2);
        lC4 = C4.toFixed(2);
        lC5 = C5.toFixed(2);
        lC6 = C6.toFixed(2);
        lC7 = C7.toFixed(2);
        lC8 = C8.toFixed(2);
        lC9 = C9.toFixed(2);
        lC10 = C10.toFixed(2);
        lCJ = CJ.toFixed(2);
        lCQ = CQ.toFixed(2);
        lCK = CK.toFixed(2);
        lD1 = D1.toFixed(2);
        lD2 = D2.toFixed(2);
        lD3 = D3.toFixed(2);
        lD4 = D4.toFixed(2);
        lD5 = D5.toFixed(2);
        lD6 = D6.toFixed(2);
        lD7 = D7.toFixed(2);
        lD8 = D8.toFixed(2);
        lD9 = D9.toFixed(2);
        lD10 = D10.toFixed(2);
        lDJ = DJ.toFixed(2);
        lDQ = DQ.toFixed(2);
        lDK = DK.toFixed(2);
        for (i = 0; i < 4; i++)
        {
            if (prediction[i].probability.toFixed(2) > 0.8)
            {
                if (i == 1)
                {
                    ank = "♧"
                }
                else if (i == 2)
                {
                    ank = "♡"
                }
                else if (i == 3)
                {
                    ank = "♢"
                }
                else if (i == 0)
                {
                    ank = "♤"
                }
                else
                {
                    ank = "何もっ"
                }
            }
        }
        for (j = 0; j < 14; j++)
        {
            if (prediction2[j].probability.toFixed(2) > 0.8)
            {
                if (j == 0)
                {
                    tal = "1"
                }
                else if (j == 1)
                {
                    tal = "2"
                }
                else if (j == 2)
                {
                    tal = "3"
                }
                else if (j == 3)
                {
                    tal = "4"
                }
                else if (j == 4)
                {
                    tal = "5"
                }
                else if (j == 5)
                {
                    tal = "6"
                }
                else if (j == 6)
                {
                    tal = "7"
                }
                else if (j == 7)
                {
                    tal = "8"
                }
                else if (j == 8)
                {
                    tal = "9"
                }
                else if (j == 9)
                {
                    tal = "10"
                }
                else if (j == 10)
                {
                    tal = "J"
                }
                else if (j == 11)
                {
                    tal = "Q"
                }
                else if (j == 12)
                {
                    tal = "K"
                }
                else if (j == 13)
                {
                    tal = "なかった"
                }
            }
        }
        if (ank == "何もっ" || tal == "なかった")
        {
            ank = "何もっ"
            tal = "なかった"
        }

        document.getElementById("debuk").textContent=ank + tal
    }
</script>
<table class="border" border="1">
    <script>
        document.write('<tr>');
        for(var i=1; i <= 10; i++){
            document.write('<th>♤'+ i +' </th>');
        }
        document.write('<th>♤'+ "J" +' </th>');
        document.write('<th>♤'+ "Q" +' </th>');
        document.write('<th>♤'+ "K" +' </th>');
        document.write('</tr>');
        document.write('<tr>');
        for(var i=1; i <= 10; i++){
            document.write('<th>♧'+ i +' </th>');
        }
        document.write('<th>♧'+ "J" +' </th>');
        document.write('<th>♧'+ "Q" +' </th>');
        document.write('<th>♧'+ "K" +' </th>');
        document.write('</tr>');
        document.write('<tr>');
        for(var i=1; i <= 10; i++){
            document.write('<th>♡'+ i +' </th>');
        }
        document.write('<th>♡'+ "J" +' </th>');
        document.write('<th>♡'+ "Q" +' </th>');
        document.write('<th>♡'+ "K" +' </th>');
        document.write('</tr>');
        document.write('<tr>');
        for(var i=1; i <= 10; i++){
            document.write('<th>♢'+ i +' </th>');
        }
        document.write('<th>♢'+ "J" +' </th>');
        document.write('<th>♢'+ "Q" +' </th>');
        document.write('<th>♢'+ "K" +' </th>');
        document.write('</tr>');
    </script>
</table>
</body>
</html>
